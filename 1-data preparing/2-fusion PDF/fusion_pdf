
import os
from PyPDF2 import PdfMerger
import time

# ğŸ•’ DÃ©but du chronomÃ©trage
start_time = time.time()

# ğŸ” Dossier contenant les 229 fichiers PDF
dossier_pdfs = "C:/Users/lenovo/Downloads/stageapplication2/pdfs"  # <-- Ã€ modifier

# ğŸ“¦ CrÃ©ation dâ€™un objet de fusion
fusionneur = PdfMerger()

# ğŸ“„ Liste triÃ©e des fichiers PDF dans le dossier
fichiers = sorted(
    [f for f in os.listdir(dossier_pdfs) if f.lower().endswith(".pdf")]
)

print(f"ğŸ“‚ {len(fichiers)} fichiers PDF trouvÃ©s. Fusion en cours...")

# ğŸ”— Ajout de chaque fichier Ã  la fusion
for i, fichier in enumerate(fichiers, 1):
    chemin_complet = os.path.join(dossier_pdfs, fichier)
    try:
        fusionneur.append(chemin_complet)
        print(f"âœ… [{i}/{len(fichiers)}] AjoutÃ© : {fichier}")
    except Exception as e:
        print(f"âš ï¸ Erreur avec {fichier} : {e}")

# ğŸ’¾ Export du fichier final fusionnÃ©
fichier_sortie = os.path.join(dossier_pdfs, "PDF_fusionne_total2.pdf")
fusionneur.write(fichier_sortie)
fusionneur.close()

# â±ï¸ Fin du chronomÃ©trage
end_time = time.time()
elapsed = end_time - start_time

print(f"\nâœ… Fusion terminÃ©e. Fichier enregistrÃ© ici : {fichier_sortie}")
print(f"â±ï¸ Temps total : {elapsed:.2f} secondes")
